<mat-card class="cardWithShadow theme-card">
    <mat-card-header>
      <mat-card-title class="m-b-0">Demande de Conge</mat-card-title>
    </mat-card-header>
    <mat-card-content class="b-t-1">
      <form [formGroup]="absenceForm" (ngSubmit)="onSubmit()">
        <div class="row">
          <div class="col-lg-6">
            <mat-label class="f-w-600 m-b-8 d-block">Date de début</mat-label>
            <mat-form-field appearance="outline" class="w-100" color="primary">
              <input matInput type="date" formControlName="dateDebut" required>
              <mat-error *ngIf="absenceForm.get('dateDebut')?.hasError('dateDebutInvalid')">
                {{ absenceForm.get('dateDebut')?.getError('dateDebutInvalid') }}
              </mat-error>
              <mat-error *ngIf="absenceForm.get('dateDebut')?.invalid && absenceForm.get('dateDebut')?.touched">
                La date de début est requise.
              </mat-error>
            </mat-form-field>            
          </div>
  
          <div class="col-lg-6">
            <mat-label class="f-w-600 m-b-8 d-block">Date de fin</mat-label>
            <mat-form-field appearance="outline" class="w-100" color="primary">
              <input matInput type="date" formControlName="dateFin" required>
              <mat-error *ngIf="absenceForm.get('dateFin')?.hasError('dateFinInvalid')">
                {{ absenceForm.get('dateFin')?.getError('dateFinInvalid') }}
              </mat-error>
              <mat-error *ngIf="absenceForm.get('dateFin')?.invalid && absenceForm.get('dateFin')?.touched">
                La date de fin est requise et doit être supérieure à la date de début.
              </mat-error>
            </mat-form-field>            
          </div>
        </div>
  
        <div >
          <mat-label class="f-w-600 m-b-8 d-block">Cause</mat-label>
          <mat-form-field appearance="outline" class="w-100">
            <mat-select class="form-control" formControlName="typeAbsence" placeholder="Cause">
              <mat-option value="maladie">Maladie</mat-option>
            <mat-option value="vacances">Vacances</mat-option>
            <mat-option value="maternite">Maternité</mat-option>
            <mat-option value="paternite">Paternité</mat-option>
            </mat-select>
            <mat-error *ngIf="absenceForm.get('typeAbsence')?.invalid && absenceForm.get('typeAbsence')?.touched">
              Le type d'absence est requis.
            </mat-error>
          </mat-form-field>
        </div>
        <div class="m-t-12">
          <button mat-flat-button color="primary" type="submit">Envoyer</button>
          <button mat-stroked-button color="warn" type="button" (click)="onReset()">Annuler</button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
  
  <mat-card class="cardWithShadow theme-card">
    <mat-card-header>
      <mat-card-title class="m-b-0">Mes demandes de congé</mat-card-title>
    </mat-card-header>
    <mat-card-content class="b-t-1">
      <div class="table-responsive">
      <table mat-table [dataSource]="leaveRequests" class="w-100"> 
        <ng-container matColumnDef="id">
          <th mat-header-cell *matHeaderCellDef class="f-w-600 mat-subtitle-1 f-s-14">ID</th>
          <td mat-cell *matCellDef="let leave">{{ leave.id }}</td>
        </ng-container>
  
        <ng-container matColumnDef="dateDebut">
          <th mat-header-cell *matHeaderCellDef class="f-w-600 mat-subtitle-1 f-s-14">Date de début</th>
          <td mat-cell *matCellDef="let leave">{{ leave.dateDebut | date:'dd/MM/yyyy' }}</td>
        </ng-container>
  
        <ng-container matColumnDef="dateFin">
          <th mat-header-cell *matHeaderCellDef class="f-w-600 mat-subtitle-1 f-s-14">Date de fin</th>
          <td mat-cell *matCellDef="let leave">{{ leave.dateFin | date:'dd/MM/yyyy' }}</td>
        </ng-container>
  
        <ng-container matColumnDef="cause">
          <th mat-header-cell *matHeaderCellDef class="f-w-600 mat-subtitle-1 f-s-14">Cause</th>
          <td mat-cell *matCellDef="let leave">{{ leave.cause }}</td>
        </ng-container>
  
        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef class="f-w-600 mat-subtitle-1 f-s-14">Statut</th>
          <td mat-cell *matCellDef="let leave">
            <mat-chip [ngClass]="getStatusClass(leave.status)">
              {{ leave.status }}
            </mat-chip>
          </td>
          
        </ng-container>
  
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef></th>
          <td mat-cell *matCellDef="let leave">
            <button mat-icon-button color="primary" (click)="onEdit(leave)" [disabled]="!isEditable(leave)">
              <mat-icon>edit</mat-icon>
            </button>
            <button mat-icon-button color="warn" (click)="onDelete(leave.id)" [disabled]="leave.status !== 'EN_COURS_DE_TRAITEMENT'">
              <mat-icon>delete</mat-icon>
            </button>
          </td>
        </ng-container>
  
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
  
      </table>
    </div>
    </mat-card-content>
  </mat-card>
  